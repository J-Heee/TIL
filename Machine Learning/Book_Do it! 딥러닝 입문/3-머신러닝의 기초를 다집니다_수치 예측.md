# Chapter 3. 머신러닝의 기초를 다집니다 - 수치 예측

## 2021.02.03

### 3-1. 선형 회귀(Linear Regression)
- 선형 회귀는 머신러닝 알고리즘 중 하나로 딥러닝의 기초가 됨
- 2차원 평면에 놓인 점을 표현하는 **1차 함수의 기울기(slope)와 절편(intercept)을 찾아줌**
- 선형 회귀로 찾은 1차 함수를 **선형 회귀로 만든 모델**이라고 부름
- 선형 회귀 모델로 **새 값 x에 대하여 y를 예측**할 수 있음
- ex) 선형 회귀 모델을 만들어 문제를 해결하는 과정
  - 미리 준비한 입력(x: 3,4,5)과 타깃(y: 25,32,39)을 가지고 모델(y=7x+4)을 만든 다음 새 입력(6)에 대한 어떤 값(46)을 예상하는 것

<br>

#### 문제 해결을 위한 당뇨병 환자의 데이터 준비하기
- 목표 : 당뇨병 환자의 1년 후 병의 진전된 정도를 예측하는 모델 만들기
- 문제를 해결하기 위해서는 **충분한 양의 입력 데이터와 타깃 데이터가 필요**
- 머신러닝, 딥러닝 패키지에는 인공지능 학습을 위한 데이터 세트(dataset)가 준비되어 있음
- 사이킷런과 케라스도 다양한 데이터 세트 제공

<br>

- 사이킷런의 당뇨병 환자의 **데이터 세트 사용**
1. load_diabetes() 함수로 당뇨병 데이터 준비하기
   ```
   from sklearn.datasets import load_diabetes   # 사이킷런의 datasets 모듈에 있는 load_diabetes() 함수 임포트
   diabetes = load_diabetes()   # 매개변수 값 없이 호출, diabetes에 당뇨병 데이터가 저장됨
   ```
   - `diabetes` 변수에 저장된 값의 자료형은 Bunch 클래스로, 파이썬 딕셔너리(dictionary)와 유사
  
<br>

2. 입력과 타깃 데이터의 크기 확인하기
   ```
   print(diabetes.data.shape, diabetes.target.shape)

   # 출력
   # (442, 10) (442,)
   ```
   - diabetes의 속성 중 `data` 속성과 `target` 속성에 입력/타깃 데이터가 넘파이 배열로 저장되어 있음
   - 넘파이 배열의 크기는 `shape` 속성에 저장되어 있음
   - `diabetes.data`
     - 442개 행과 10개 열로 구성된 2차원 배열
     - **샘플(sample)** : **행**, 당뇨병 환자에 대한 특성(수치)으로 이루어진 데이터 1세트
     - 샘플의 **특성(feature)** : **열**, 당뇨병 데이터의 여러 특징들 (ex.환자의 혈압, 혈당, 몸무게 등)
     - 입력데이터의 특성은 속성, 독립 변수(independent variable), 설명 변수(explanatory variable) 등으로 부름
   - `diabetes.target`
     - 442개의 요소를 가진 1차원 배열 

<br>

3. 입력 데이터 자세히 보기
   ```
   diabetes.data[0:3]   # 입력 데이터 앞부분의 샘플 3개 출력
   ```
   ```
   # 출력
   array([[ 0.03807591,  0.05068012,  0.06169621,  0.02187235, -0.0442235 ,
        -0.03482076, -0.04340085, -0.00259226,  0.01990842, -0.01764613],   # 첫 번째 샘플, 특성의 값 10개 나열
       [-0.00188202, -0.04464164, -0.05147406, -0.02632783, -0.00844872,
        -0.01916334,  0.07441156, -0.03949338, -0.06832974, -0.09220405],   # 두 번째 샘플
       [ 0.08529891,  0.05068012,  0.04445121, -0.00567061, -0.04559945,
        -0.03419447, -0.03235593, -0.00259226,  0.00286377, -0.02593034]])  # 세 번째 샘플
   ```

<br>

4. 타깃 데이터 자세히 보기
   ```
   diabetes.target[:3]

   # 출력
   # array([151.,  75., 141.])
   ```
   - **타깃 데이터는 10개의 요소로 구성된 샘플 1개에 대응**
- 입력/타깃 데이터의 수치가 무엇을 의미하는지는 알 필요 없음 => 전문가 영역
- 우리는 입력 데이터와 타깃 데이터의 수치만 보고 둘 사이의 규칙(모델)을 찾으면 되는 것!

<br>

#### 당뇨병 환자 데이터 시각화하기
1. 맷플롯립의 scatter() 함수로 산점도 그리기
   - 당뇨병 데이터 세트의 10개의 특성을 모두 표현하려면 3차원 이상의 그래프 필요
   - 3차원 이상의 그래프는 그릴 수 없으므로 1개의 특성만 사용
   ```
   import matplotlib.pyplot as plt
   plt.scatter(diabetes.data[:, 2], diabetes.target)    # 세 번째 특성과 타깃 데이터로 산점도 그림
   plt.xlabel('x')   # x축은 diabetes.data의 세 번째 특성
   plt.ylabel('y')   # y축은 diabetes.target 
   plt.show()

   # 그래프가 정비례 관계를 나타냄
   ``` 
2. 훈련 데이터 준비하기
   - 매번 diabetes.data를 입력하는 것은 번거로우니 미리 분리하여 저장해두기
   - 이후에는 x와 y에 있는 데이터를 이용해 모델 훈련
   ```
   x = diabetes.data[:, 2]   # 입력 데이터의 세 번째 특성을 변수 x에 저장
   y = diabetes.target    # 타깃 데이터는 변수 y에 저장
   ```

<br>
